import{r as t,h as n,g as r}from"./p-1b575ba2.js";let i,u,e=!1;const o=new Promise((t,n)=>{i=t,u=n});var s="http://www.w3.org/1999/xhtml";const f={svg:"http://www.w3.org/2000/svg",xhtml:s,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function h(t){var n=t+="",r=n.indexOf(":");return r>=0&&"xmlns"!==(n=t.slice(0,r))&&(t=t.slice(r+1)),f.hasOwnProperty(n)?{space:f[n],local:t}:t}function c(t){return function(){var n=this.ownerDocument,r=this.namespaceURI;return r===s&&n.documentElement.namespaceURI===s?n.createElement(t):n.createElementNS(r,t)}}function a(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function l(t){var n=h(t);return(n.local?a:c)(n)}function v(){}function w(t){return null==t?v:function(){return this.querySelector(t)}}function p(){return[]}function y(t){return new Array(t.length)}function d(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function m(t,n,r,i,u,e){for(var o,s=0,f=n.length,h=e.length;s<h;++s)(o=n[s])?(o.__data__=e[s],i[s]=o):r[s]=new d(t,e[s]);for(;s<f;++s)(o=n[s])&&(u[s]=o)}function g(t,n,r,i,u,e,o){var s,f,h,c={},a=n.length,l=e.length,v=new Array(a);for(s=0;s<a;++s)(f=n[s])&&(v[s]=h="$"+o.call(f,f.__data__,s,n),h in c?u[s]=f:c[h]=f);for(s=0;s<l;++s)(f=c[h="$"+o.call(t,e[s],s,e)])?(i[s]=f,f.__data__=e[s],c[h]=null):r[s]=new d(t,e[s]);for(s=0;s<a;++s)(f=n[s])&&c[v[s]]===f&&(u[s]=f)}function A(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function M(t){return function(){this.removeAttribute(t)}}function x(t){return function(){this.removeAttributeNS(t.space,t.local)}}function $(t,n){return function(){this.setAttribute(t,n)}}function _(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function b(t,n){return function(){var r=n.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}}function k(t,n){return function(){var r=n.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function j(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function z(t){return function(){this.style.removeProperty(t)}}function B(t,n,r){return function(){this.style.setProperty(t,n,r)}}function C(t,n,r){return function(){var i=n.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,r)}}function N(t,n){return t.style.getPropertyValue(n)||j(t).getComputedStyle(t,null).getPropertyValue(n)}function R(t){return function(){delete this[t]}}function S(t,n){return function(){this[t]=n}}function q(t,n){return function(){var r=n.apply(this,arguments);null==r?delete this[t]:this[t]=r}}function D(t){return t.trim().split(/^|\s+/)}function I(t){return t.classList||new L(t)}function L(t){this._node=t,this._names=D(t.getAttribute("class")||"")}function X(t,n){for(var r=I(t),i=-1,u=n.length;++i<u;)r.add(n[i])}function E(t,n){for(var r=I(t),i=-1,u=n.length;++i<u;)r.remove(n[i])}function G(t){return function(){X(this,t)}}function O(t){return function(){E(this,t)}}function P(t,n){return function(){(n.apply(this,arguments)?X:E)(this,t)}}function T(){this.textContent=""}function U(t){return function(){this.textContent=t}}function Y(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function F(){this.innerHTML=""}function H(t){return function(){this.innerHTML=t}}function J(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function K(){this.nextSibling&&this.parentNode.appendChild(this)}function Q(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function V(){return null}function W(){var t=this.parentNode;t&&t.removeChild(this)}function Z(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function tt(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}d.prototype={constructor:d,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},L.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var nt={};function rt(t,n,r){return t=it(t,n,r),function(n){var r=n.relatedTarget;r&&(r===this||8&r.compareDocumentPosition(this))||t.call(this,n)}}function it(t,n,r){return function(){try{t.call(this,this.__data__,n,r)}finally{}}}function ut(t){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}}))}function et(t){return function(){var n=this.__on;if(n){for(var r,i=0,u=-1,e=n.length;i<e;++i)r=n[i],t.type&&r.type!==t.type||r.name!==t.name?n[++u]=r:this.removeEventListener(r.type,r.listener,r.capture);++u?n.length=u:delete this.__on}}}function ot(t,n,r){var i=nt.hasOwnProperty(t.type)?rt:it;return function(u,e,o){var s,f=this.__on,h=i(n,e,o);if(f)for(var c=0,a=f.length;c<a;++c)if((s=f[c]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=h,s.capture=r),void(s.value=n);this.addEventListener(t.type,h,r),s={type:t.type,name:t.name,value:n,listener:h,capture:r},f?f.push(s):this.__on=[s]}}function st(t,n,r){var i=j(t),u=i.CustomEvent;"function"==typeof u?u=new u(n,r):(u=i.document.createEvent("Event"),r?(u.initEvent(n,r.bubbles,r.cancelable),u.detail=r.detail):u.initEvent(n,!1,!1)),t.dispatchEvent(u)}function ft(t,n){return function(){return st(this,t,n)}}function ht(t,n){return function(){return st(this,t,n.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(nt={mouseenter:"mouseover",mouseleave:"mouseout"}));var ct=[null];function at(t,n){this._groups=t,this._parents=n}function lt(){}function vt(t,n){var r=new lt;if(t instanceof lt)t.each((function(t,n){r.set(n,t)}));else if(Array.isArray(t)){var i,u=-1,e=t.length;if(null==n)for(;++u<e;)r.set(u,t[u]);else for(;++u<e;)r.set(n(i=t[u],u,t),i)}else if(t)for(var o in t)r.set(o,t[o]);return r}at.prototype=function(){return new at([[document.documentElement]],ct)}.prototype={constructor:at,select:function(t){"function"!=typeof t&&(t=w(t));for(var n=this._groups,r=n.length,i=new Array(r),u=0;u<r;++u)for(var e,o,s=n[u],f=s.length,h=i[u]=new Array(f),c=0;c<f;++c)(e=s[c])&&(o=t.call(e,e.__data__,c,s))&&("__data__"in e&&(o.__data__=e.__data__),h[c]=o);return new at(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?p:function(){return this.querySelectorAll(t)}}(t));for(var n=this._groups,r=n.length,i=[],u=[],e=0;e<r;++e)for(var o,s=n[e],f=s.length,h=0;h<f;++h)(o=s[h])&&(i.push(t.call(o,o.__data__,h,s)),u.push(o));return new at(i,u)},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var n=this._groups,r=n.length,i=new Array(r),u=0;u<r;++u)for(var e,o=n[u],s=o.length,f=i[u]=[],h=0;h<s;++h)(e=o[h])&&t.call(e,e.__data__,h,o)&&f.push(e);return new at(i,this._parents)},data:function(t,n){if(!t)return w=new Array(this.size()),c=-1,this.each((function(t){w[++c]=t})),w;var r,i=n?g:m,u=this._parents,e=this._groups;"function"!=typeof t&&(r=t,t=function(){return r});for(var o=e.length,s=new Array(o),f=new Array(o),h=new Array(o),c=0;c<o;++c){var a=u[c],l=e[c],v=l.length,w=t.call(a,a&&a.__data__,c,u),p=w.length,y=f[c]=new Array(p),d=s[c]=new Array(p);i(a,l,y,d,h[c]=new Array(v),w,n);for(var A,M,x=0,$=0;x<p;++x)if(A=y[x]){for(x>=$&&($=x+1);!(M=d[$])&&++$<p;);A._next=M||null}}return(s=new at(s,u))._enter=f,s._exit=h,s},enter:function(){return new at(this._enter||this._groups.map(y),this._parents)},exit:function(){return new at(this._exit||this._groups.map(y),this._parents)},join:function(t,n,r){var i=this.enter(),u=this,e=this.exit();return i="function"==typeof t?t(i):i.append(t+""),null!=n&&(u=n(u)),null==r?e.remove():r(e),i&&u?i.merge(u).order():u},merge:function(t){for(var n=this._groups,r=t._groups,i=n.length,u=Math.min(i,r.length),e=new Array(i),o=0;o<u;++o)for(var s,f=n[o],h=r[o],c=f.length,a=e[o]=new Array(c),l=0;l<c;++l)(s=f[l]||h[l])&&(a[l]=s);for(;o<i;++o)e[o]=n[o];return new at(e,this._parents)},order:function(){for(var t=this._groups,n=-1,r=t.length;++n<r;)for(var i,u=t[n],e=u.length-1,o=u[e];--e>=0;)(i=u[e])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function n(n,r){return n&&r?t(n.__data__,r.__data__):!n-!r}t||(t=A);for(var r=this._groups,i=r.length,u=new Array(i),e=0;e<i;++e){for(var o,s=r[e],f=s.length,h=u[e]=new Array(f),c=0;c<f;++c)(o=s[c])&&(h[c]=o);h.sort(n)}return new at(u,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each((function(){t[++n]=this})),t},node:function(){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],u=0,e=i.length;u<e;++u){var o=i[u];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,r=0,i=n.length;r<i;++r)for(var u,e=n[r],o=0,s=e.length;o<s;++o)(u=e[o])&&t.call(u,u.__data__,o,e);return this},attr:function(t,n){var r=h(t);if(arguments.length<2){var i=this.node();return r.local?i.getAttributeNS(r.space,r.local):i.getAttribute(r)}return this.each((null==n?r.local?x:M:"function"==typeof n?r.local?k:b:r.local?_:$)(r,n))},style:function(t,n,r){return arguments.length>1?this.each((null==n?z:"function"==typeof n?C:B)(t,n,null==r?"":r)):N(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?R:"function"==typeof n?q:S)(t,n)):this.node()[t]},classed:function(t,n){var r=D(t+"");if(arguments.length<2){for(var i=I(this.node()),u=-1,e=r.length;++u<e;)if(!i.contains(r[u]))return!1;return!0}return this.each(("function"==typeof n?P:n?G:O)(r,n))},text:function(t){return arguments.length?this.each(null==t?T:("function"==typeof t?Y:U)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?F:("function"==typeof t?J:H)(t)):this.node().innerHTML},raise:function(){return this.each(K)},lower:function(){return this.each(Q)},append:function(t){var n="function"==typeof t?t:l(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var r="function"==typeof t?t:l(t),i=null==n?V:"function"==typeof n?n:w(n);return this.select((function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(W)},clone:function(t){return this.select(t?tt:Z)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,r){var i,u,e=ut(t+""),o=e.length;if(!(arguments.length<2)){for(s=n?ot:et,null==r&&(r=!1),i=0;i<o;++i)this.each(s(e[i],n,r));return this}var s=this.node().__on;if(s)for(var f,h=0,c=s.length;h<c;++h)for(i=0,f=s[h];i<o;++i)if((u=e[i]).type===f.type&&u.name===f.name)return f.value},dispatch:function(t,n){return this.each(("function"==typeof n?ht:ft)(t,n))}},lt.prototype=vt.prototype={constructor:lt,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,n){return this["$"+t]=n,this},remove:function(t){var n="$"+t;return n in this&&delete this[n]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(n.slice(1));return t},values:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(this[n]);return t},entries:function(){var t=[];for(var n in this)"$"===n[0]&&t.push({key:n.slice(1),value:this[n]});return t},size:function(){var t=0;for(var n in this)"$"===n[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var n in this)"$"===n[0]&&t(this[n],n.slice(1),this)}};const wt=class{constructor(n){t(this,n)}async componentDidRender(){await function(){if(e)return o;e=!0,window.initMap=()=>i();const t=document.createElement("script");return t.async=!0,t.defer=!0,t.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAjigXRm-xmYiNyOoLMB2p1UmtauinyAy0&callback=initMap",t.onerror=u,document.querySelector("head").appendChild(t),o}(),this.pointsLocation=await fetch("./assets/datasets/points-location.json").then(t=>t.json()),this.map=new google.maps.Map(this.el.shadowRoot.querySelector(".map"),{zoom:5,center:new google.maps.LatLng(40.4165,-3.70256),mapTypeId:google.maps.MapTypeId.TERRAIN});let t=new google.maps.OverlayView;t.onAdd=()=>{this.originalBounds=this.map.getBounds(),this.canvas=function(t){return"string"==typeof t?new at([[document.querySelector(t)]],[document.documentElement]):new at([[t]],ct)}(t.getPanes().overlayLayer).append("canvas").style("position","absolute").style("left",`-${this.map.getDiv().offsetWidth/2}px`).style("top",`-${this.map.getDiv().offsetHeight/2}px`).attr("width",this.map.getDiv().offsetWidth).attr("height",this.map.getDiv().offsetHeight);let n=this.canvas.node().getContext("2d");n.translate(this.map.getDiv().offsetWidth/2,this.map.getDiv().offsetHeight/2);let r=this.generateColorGradient(),i=this.originalBounds.getNorthEast(),u=this.originalBounds.getSouthWest().lng(),e=i.lng(),o=i.lat(),s=this.getDistance(new google.maps.LatLng(u,o),new google.maps.LatLng(e,o))/this.map.getDiv().offsetWidth,f=this.generateBrushes(vt(this.pointsLocation,(function(t){return Math.round(t.radius)})).keys(),s);t.draw=()=>{this.projection=t.getProjection(),n.save(),n.clearRect(-this.map.getDiv().offsetWidth/2,-this.map.getDiv().offsetHeight/2,this.map.getDiv().offsetWidth,this.map.getDiv().offsetHeight),this.drawCircles(n,f);let i=n.getImageData(0,0,this.map.getDiv().offsetWidth,this.map.getDiv().offsetHeight);this.colorize(i.data,r),n.putImageData(i,0,0),n.restore()}},t.setMap(this.map)}generateColorGradient(){var t={.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},n=document.createElement("canvas"),r=n.getContext("2d"),i=r.createLinearGradient(0,0,0,256);for(var u in n.width=1,n.height=256,t)i.addColorStop(+u,t[u]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.getImageData(0,0,1,256).data}colorize(t,n){for(var r,i=0,u=t.length;i<u;i+=4)(r=4*t[i+3])&&(t[i]=n[r],t[i+1]=n[r+1],t[i+2]=n[r+2])}drawCircles(t,n){this.pointsLocation.forEach(r=>{t.globalAlpha=.1;let i=this.projection.fromLatLngToDivPixel(new google.maps.LatLng(r.latitude,r.longitude)),u=n[r.radius];t.drawImage(u.brush,i.x-u.radius,i.y-u.radius)})}generateBrushes(t,n){let r={};return t.forEach(t=>{let i=Math.round(3*t/4/n),u=Math.round(t/4/n),e=i+u,o=document.createElement("canvas"),s=o.getContext("2d");o.width=o.height=2*e,s.shadowOffsetX=s.shadowOffsetY=2*e,s.shadowBlur=i,s.shadowColor="black",s.beginPath(),s.arc(-e,-e,u,0,2*Math.PI),s.closePath(),s.fill(),r[t]={brush:o,radius:e}}),r}getDistance(t,n){var r=this.toRad(n.lat()-t.lat()),i=this.toRad(n.lng()-t.lng()),u=Math.sin(r/2)*Math.sin(r/2)+Math.cos(this.toRad(t.lat()))*Math.cos(this.toRad(n.lat()))*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))*6378137/1e3}toRad(t){return t*Math.PI/180}render(){return n("div",null,n("div",{class:"map"}))}get el(){return r(this)}};wt.style=".map{width:1200px;height:600px}";export{wt as my_googlemap}